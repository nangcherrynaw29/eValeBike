<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test in Progress</title>
  <link rel="stylesheet" th:href="@{/webjars/bootstrap/5.3.3/css/bootstrap.min.css}">
</head>
<body>
<div class="container mt-5 text-center">
  <h2>Running Test...</h2>
  <div class="spinner-border text-primary" role="status">
    <span class="visually-hidden">Loading...</span>
  </div>
  <p class="mt-3">Test ID: <span th:text="${testId}"></span>. Please wait while the test completes.</p>
  <div id="error" class="alert alert-danger mt-3" style="display: none;"></div>
</div>
<script th:src="@{/webjars/bootstrap/5.3.3/js/bootstrap.bundle.min.js}"></script>
<!--<script th:inline="javascript">-->
<!--  document.addEventListener('DOMContentLoaded', () => {-->
<!--    const testId = /*[[${testId}]]*/ '';-->
<!--    const errorDiv = document.getElementById('error');-->

<!--    function pollTestStatus() {-->
<!--      fetch(`/technician/get-test-result/${testId}`, { method: 'GET' })-->
<!--              .then(response => {-->
<!--                if (!response.ok) {-->
<!--                  throw new Error('Failed to fetch test status: ' + response.status);-->
<!--                }-->
<!--                return response.json();-->
<!--              })-->
<!--              .then(result => {-->
<!--                if (result.state === 'COMPLETED') {-->
<!--                  window.location.href = `/technician/test-result/${testId}`;-->
<!--                } else {-->
<!--                  setTimeout(pollTestStatus, 2000); // Poll every 2 seconds-->
<!--                }-->
<!--              })-->
<!--              .catch(error => {-->
<!--                errorDiv.textContent = `Error: ${error.message}. Redirecting to dashboard...`;-->
<!--                errorDiv.style.display = 'block';-->
<!--                setTimeout(() => window.location.href = '/technician/bike-dashboard', 3000);-->
<!--              });-->
<!--    }-->

<!--    pollTestStatus(); // Start polling-->
<!--  });-->
<!--</script>-->
</body>
</html>